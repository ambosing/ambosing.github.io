{"componentChunkName":"component---src-templates-post-template-tsx","path":"/airflow/regex/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2 id=\"들어가기-전에\" style=\"position:relative;\"><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84%EC%97%90\" aria-label=\"들어가기 전에 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>들어가기 전에</h2>\n<p>저는 회사에서 데이터를 배치하는 작업을 많이 했었습니다. 그 중에 처음으로 도전한 것은 바로 예전 학생 때 프로젝트했던 Linux Cron 배치 작업으로 배치 데이터를 프로세싱 중이었는데요.<br>\n이것보다 더 좋은 것이 없을까하는 생각이 매번 들긴 했었습니다. 그 당시에만 해도 모든 서버를 온프레미스로 돌리고 있는 상황이었습니다!<br>\n이렇게 하다보니 컴퓨터가 꺼지거나 배치 작업이 돌아가지 않을 때는 운영팀의 보고를 통해서만 받게 되었습니다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/e373f73b0c15e7a4d4d103a7b40c30e5/84f9f/2023-08-01-14-59-32.webp\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 31.770833333333332%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRmwAAABXRUJQVlA4IGAAAACwAwCdASoUAAYAPtFWpEuoJKOhsAgBABoJZwAD42IN75/p79QgAAD+x1/zRYSa57p4jh/afp/nnBFwmOoC21xjSIbzjxbAyXE2KPq1Hl526FBCb910qRqZyBDn04AAAAA='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/e373f73b0c15e7a4d4d103a7b40c30e5/a59e9/2023-08-01-14-59-32.webp 192w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/0ca9f/2023-08-01-14-59-32.webp 384w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/dc9b9/2023-08-01-14-59-32.webp 768w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/e2c2f/2023-08-01-14-59-32.webp 1152w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/f3efb/2023-08-01-14-59-32.webp 1536w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/84f9f/2023-08-01-14-59-32.webp 1552w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/e373f73b0c15e7a4d4d103a7b40c30e5/a59e9/2023-08-01-14-59-32.webp 192w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/0ca9f/2023-08-01-14-59-32.webp 384w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/dc9b9/2023-08-01-14-59-32.webp 768w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/e2c2f/2023-08-01-14-59-32.webp 1152w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/f3efb/2023-08-01-14-59-32.webp 1536w,\n/static/e373f73b0c15e7a4d4d103a7b40c30e5/84f9f/2023-08-01-14-59-32.webp 1552w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/webp\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/e373f73b0c15e7a4d4d103a7b40c30e5/dc9b9/2023-08-01-14-59-32.webp\"\n            alt=\"기존이미지\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<div class=\"source\"> 온프레미스 당시 인프라</div>\n<p>회사에서 AWS 사용해보기로 결정이 됐습니다.  기존에 있던 배치 시스템을 변경할 기회였습니다.<br>\n그래서 AWS에서 배치 작업을 더 좋게 처리하는 방법이 없을까하다가 Lambda + EventBridge로 처리하게 했었습니다.<br>\n이번엔 Severless 서비스인 Lambda를 사용하니깐 컴퓨터가 문제일 경우는 없었습니다만 만약 데이터의 정합성의 문제로 에러가 발생한다면 기존의 배치 작업을 다시 돌려야하는 문제가 생겼습니다.\n<span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/1b85444b25498e5002dd7c6d234316e8/da9ed/2023-08-01-15-56-08.webp\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 40.625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/webp;base64,UklGRmwAAABXRUJQVlA4IGAAAADQAwCdASoUAAgAPtFipk0oJiOiMAgBABoJQApgWZQEz6JrwXASOgAA/v5hO5mI8DVfEvop7ZGEBe06CFhYaRQZ6cixN64DP4iBpz1nABoSE4WnMxHURDXEvyP7A3paAAA='); background-size: cover; display: block;\"\n  ></span>\n  <picture>\n          <source\n              srcset=\"/static/1b85444b25498e5002dd7c6d234316e8/a59e9/2023-08-01-15-56-08.webp 192w,\n/static/1b85444b25498e5002dd7c6d234316e8/0ca9f/2023-08-01-15-56-08.webp 384w,\n/static/1b85444b25498e5002dd7c6d234316e8/dc9b9/2023-08-01-15-56-08.webp 768w,\n/static/1b85444b25498e5002dd7c6d234316e8/e2c2f/2023-08-01-15-56-08.webp 1152w,\n/static/1b85444b25498e5002dd7c6d234316e8/da9ed/2023-08-01-15-56-08.webp 1277w\"\n              sizes=\"(max-width: 768px) 100vw, 768px\"\n              type=\"image/webp\"\n            />\n          <source\n            srcset=\"/static/1b85444b25498e5002dd7c6d234316e8/a59e9/2023-08-01-15-56-08.webp 192w,\n/static/1b85444b25498e5002dd7c6d234316e8/0ca9f/2023-08-01-15-56-08.webp 384w,\n/static/1b85444b25498e5002dd7c6d234316e8/dc9b9/2023-08-01-15-56-08.webp 768w,\n/static/1b85444b25498e5002dd7c6d234316e8/e2c2f/2023-08-01-15-56-08.webp 1152w,\n/static/1b85444b25498e5002dd7c6d234316e8/da9ed/2023-08-01-15-56-08.webp 1277w\"\n            sizes=\"(max-width: 768px) 100vw, 768px\"\n            type=\"image/webp\"\n          />\n          <img\n            class=\"gatsby-resp-image-image\"\n            src=\"/static/1b85444b25498e5002dd7c6d234316e8/dc9b9/2023-08-01-15-56-08.webp\"\n            alt=\"2023 08 01 15 56 08\"\n            title=\"\"\n            loading=\"lazy\"\n            decoding=\"async\"\n            style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n          />\n        </picture>\n  </a>\n    </span></p>\n<div class=\"source\"> AWS 당시 인프라</div>\n<p>그러다가 데이터 엔지니어링에 대해 관심을 가지고 있었습니다. 그 중 Airflow라는 기술이 있었는데요. Airflow는 이전에 했던 배치 시스템의 단점들을 보완하고 있었습니다..!<br>\n그래서 이번 글에서는 Airflow를 설치하는 방법과 Git Action으로 AWS EC2에 배포하는 방법을 알아보겠습니다.<br>\n<del>왜 AWS EC2냐고 하면 .. 제가 쓰고 있는 환경이라서..</del></p>\n<h2 id=\"docker-compose로-airflow-설치하기\" style=\"position:relative;\"><a href=\"#docker-compose%EB%A1%9C-airflow-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\"docker compose로 airflow 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Docker compose로 Airflow 설치하기</h2>\n<p>저는 Docker compose로 로컬(윈도우)에 설치를 해주었습니다. 로컬 설치과정은 쉽기 때문에 이번 설치 과정은 Amazon linux 환경에서 진행된다는 점을 알고계시면 좋을 것 같습니다. Docker compose로 설치를 진행하도록 하겠습니다!</p>\n<h4 id=\"amazon-linux2-환경에서-docker-설치하기\" style=\"position:relative;\"><a href=\"#amazon-linux2-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-docker-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\"amazon linux2 환경에서 docker 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Amazon linux2 환경에서 Docker 설치하기</h4>\n<p>Amazone-linux2에 도커를 설치합니다.<br>\nsudo는 언제나 필수입니다! (안그러면 권한 없다고 에러를 냅니다! ㅠㅠ)</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">sudo</span> amazon-linux-extras <span class=\"token function\">install</span> <span class=\"token function\">docker</span></code></pre></div>\n<p>그런 다음 도커를 시작합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">sudo</span> <span class=\"token function\">service</span> <span class=\"token function\">docker</span> start</code></pre></div>\n<p>현재 사용자를 docker 그룹에 추가합니다. 이를 통해 sudo를 사용하지 않고도 Docker를 실행할 수 있습니다</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">sudo</span> <span class=\"token function\">usermod</span> <span class=\"token parameter variable\">-aG</span> <span class=\"token function\">docker</span> <span class=\"token environment constant\">$USER</span></code></pre></div>\n<h4 id=\"amazon-linux2에서-docker-compose-설치\" style=\"position:relative;\"><a href=\"#amazon-linux2%EC%97%90%EC%84%9C-docker-compose-%EC%84%A4%EC%B9%98\" aria-label=\"amazon linux2에서 docker compose 설치 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Amazon linux2에서 Docker Compose 설치</h4>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">sudo</span> <span class=\"token function\">curl</span> <span class=\"token parameter variable\">-L</span> <span class=\"token string\">\"https://github.com/docker/compose/releases/latest/download/docker-compose-<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-s</span><span class=\"token variable\">)</span></span>-<span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token function\">uname</span> <span class=\"token parameter variable\">-m</span><span class=\"token variable\">)</span></span>\"</span> <span class=\"token parameter variable\">-o</span> /usr/local/bin/docker-compose</code></pre></div>\n<p>실행 권한을 부여해줍니다</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">sudo</span> <span class=\"token function\">chmod</span> +x /usr/local/bin/docker-compose</code></pre></div>\n<p>도커 컴포즈가 잘 설치되었는지 확인해봅니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\"><span class=\"token function\">docker-compose</span> <span class=\"token parameter variable\">--version</span></code></pre></div>\n<p>윈도우에서는 <code class=\"language-text\">docker compose</code>이었는데 리눅스에서는 <code class=\"language-text\">docker-compose</code>입니다!</p>\n<h4 id=\"amazon-linux2에-docker-compose로-airflow-설치하기\" style=\"position:relative;\"><a href=\"#amazon-linux2%EC%97%90-docker-compose%EB%A1%9C-airflow-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\" aria-label=\"amazon linux2에 docker compose로 airflow 설치하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Amazon-linux2에 Docker-compose로 Airflow 설치하기</h4>","tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84%EC%97%90\">들어가기 전에</a></p>\n</li>\n<li>\n<p><a href=\"#docker-compose%EB%A1%9C-airflow-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">Docker compose로 Airflow 설치하기</a></p>\n<ul>\n<li>\n<ul>\n<li><a href=\"#amazon-linux2-%ED%99%98%EA%B2%BD%EC%97%90%EC%84%9C-docker-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">Amazon linux2 환경에서 Docker 설치하기</a></li>\n<li><a href=\"#amazon-linux2%EC%97%90%EC%84%9C-docker-compose-%EC%84%A4%EC%B9%98\">Amazon linux2에서 Docker Compose 설치</a></li>\n<li><a href=\"#amazon-linux2%EC%97%90-docker-compose%EB%A1%9C-airflow-%EC%84%A4%EC%B9%98%ED%95%98%EA%B8%B0\">Amazon-linux2에 Docker-compose로 Airflow 설치하기</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>","frontmatter":{"title":"Amazon-linux2 Docker Compose Airflow 설치와 Git Action 배포 자동화","summary":"으어어.. 에러가 났떤 지난날들","date":"2023.08.01.","categories":["Airflow"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/webp;base64,UklGRvwAAABXRUJQVlA4IPAAAACwBQCdASoUABQAAAAAJaQDLs2AOAA6RjyVZ4AcyT+M2igZIByhf9q/KHjK/0zOzXrCCarYswAA/v//vi4vw/8C9ZQ7H+H//yCwbQPvsZtVP/0ES//obRwOWqfhB6QluKlBWVv/00//+CZuyt2HnR8rj3PH4g+AF7BjHL/DERmaNf+iMa2Vn/8w5vZ6J8f/zWL84nce2QIW+sKRZGr/3/++a+72/AQG7P0f+Vx+2n8ZbXOmM113LcubNJdYTmvhHp8ioh/Ssay6McI8Hv4WzVhoxfjdbd0Vnn7uGhnuuiz+QfZ5Lvn/yafX9rRFNCCAAAA="},"images":{"fallback":{"src":"/static/97afc7f825b0ddb0803e2cd1be787df7/9c0a1/chocoball.webp","srcSet":"/static/97afc7f825b0ddb0803e2cd1be787df7/e64f1/chocoball.webp 100w,\n/static/97afc7f825b0ddb0803e2cd1be787df7/8b00d/chocoball.webp 200w,\n/static/97afc7f825b0ddb0803e2cd1be787df7/9c0a1/chocoball.webp 400w","sizes":"(min-width: 400px) 400px, 100vw"},"sources":[]},"width":400,"height":400}},"publicURL":"/static/97afc7f825b0ddb0803e2cd1be787df7/chocoball.webp"}}}}]}},"pageContext":{"slug":"/airflow/regex/"}},"staticQueryHashes":["2269898903"],"slicesMap":{}}