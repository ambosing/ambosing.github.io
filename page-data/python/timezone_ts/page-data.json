{"componentChunkName":"component---src-templates-post-template-tsx","path":"/python/timezone_ts/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h2 id=\"들어가기-전\" style=\"position:relative;\"><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84\" aria-label=\"들어가기 전 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>들어가기 전</h2>\n<p>회사에서 Timezone을 UTC를 KST로 조작할 일이 있었습니다!<br>\n그래서 간단하게 해결할 방법으로 timezone을 KST로 조작해주었습니다.<br>\n하지만 예상하는 날짜 값이 도출된 것이 아니라 예상 날짜 값보다 하루가 전 날이 나왔습니다.</p>\n<h2 id=\"왜-예상대로-안됐을까\" style=\"position:relative;\"><a href=\"#%EC%99%9C-%EC%98%88%EC%83%81%EB%8C%80%EB%A1%9C-%EC%95%88%EB%90%90%EC%9D%84%EA%B9%8C\" aria-label=\"왜 예상대로 안됐을까 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>왜 예상대로 안됐을까</h2>\n<p>먼저 일단 예제로 제가 구성한 코드를 보시는 게 이해가 더 빠르실 거라 먼저 코드를 보여드리겠습니다.</p>\n<div class=\"code-header\">\r\n\t<span class=\"red btn\"></span>\r\n\t<span class=\"yellow btn\"></span>\r\n\t<span class=\"green btn\"></span>\r\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> datetime <span class=\"token keyword\">import</span> datetime<span class=\"token punctuation\">,</span> timedelta\r\n<span class=\"token keyword\">from</span> dateutil <span class=\"token keyword\">import</span> tz\r\n\r\nlocal_tz <span class=\"token operator\">=</span> tz<span class=\"token punctuation\">.</span>gettz<span class=\"token punctuation\">(</span><span class=\"token string\">'Asia/Seoul'</span><span class=\"token punctuation\">)</span>\r\n\r\na <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">(</span><span class=\"token number\">2023</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">00</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span>\r\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>astimezone<span class=\"token punctuation\">(</span>local_tz<span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span>\r\nb <span class=\"token operator\">-=</span> timedelta<span class=\"token punctuation\">(</span>days<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">'%Y-%m-%d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token number\">2023</span><span class=\"token operator\">-</span><span class=\"token number\">07</span><span class=\"token operator\">-</span><span class=\"token number\">23</span> <span class=\"token number\">15</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span>\r\n<span class=\"token number\">2023</span><span class=\"token operator\">-</span><span class=\"token number\">07</span><span class=\"token operator\">-</span><span class=\"token number\">23</span> <span class=\"token number\">15</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">09</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span>\r\n<span class=\"token number\">2023</span><span class=\"token operator\">-</span><span class=\"token number\">07</span><span class=\"token operator\">-</span><span class=\"token number\">22</span></code></pre></div>\n<p>저는 일단 처음 15시로 되어 있던 시간을 KST(+9시간)을 함으로써 다음 날이 되게 하려고 했습니다.<br>\n하지만 1번과 같이 보시다시피 <code class=\"language-text\">2023-07-23 15:00:00+09:00</code> 이런 결과가 나왔습니다.<br>\n그래서 2번에서 날짜를 하나 빼서 날짜만 String 값으로 변경해보니 예상했던 결과인 <code class=\"language-text\">2023-07-23</code>이 아닌 <code class=\"language-text\">2023-07-22</code>가 나왔습니다.</p>\n<h2 id=\"해결-방법\" style=\"position:relative;\"><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\" aria-label=\"해결 방법 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>해결 방법</h2>\n<div class=\"code-header\">\r\n\t<span class=\"red btn\"></span>\r\n\t<span class=\"yellow btn\"></span>\r\n\t<span class=\"green btn\"></span>\r\n</div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">local_tz <span class=\"token operator\">=</span> tz<span class=\"token punctuation\">.</span>gettz<span class=\"token punctuation\">(</span><span class=\"token string\">'Asia/Seoul'</span><span class=\"token punctuation\">)</span>\r\n\r\na <span class=\"token operator\">=</span> datetime<span class=\"token punctuation\">(</span><span class=\"token number\">2023</span><span class=\"token punctuation\">,</span> <span class=\"token number\">7</span><span class=\"token punctuation\">,</span> <span class=\"token number\">23</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">,</span> <span class=\"token number\">00</span><span class=\"token punctuation\">,</span> <span class=\"token number\">00</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 1</span>\r\na <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>replace<span class=\"token punctuation\">(</span>tzinfo<span class=\"token operator\">=</span>tz<span class=\"token punctuation\">.</span>UTC<span class=\"token punctuation\">)</span> <span class=\"token comment\"># &lt;- 해결 방법</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 2</span>\r\nb <span class=\"token operator\">=</span> a<span class=\"token punctuation\">.</span>astimezone<span class=\"token punctuation\">(</span>local_tz<span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span> <span class=\"token comment\"># 3</span>\r\nb <span class=\"token operator\">-=</span> timedelta<span class=\"token punctuation\">(</span>days<span class=\"token operator\">=</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\r\n<span class=\"token keyword\">print</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">.</span>strftime<span class=\"token punctuation\">(</span><span class=\"token string\">'%Y-%m-%d'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token comment\"># 4</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token number\">2023</span><span class=\"token operator\">-</span><span class=\"token number\">07</span><span class=\"token operator\">-</span><span class=\"token number\">23</span> <span class=\"token number\">15</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span> <span class=\"token comment\"># 1</span>\r\n<span class=\"token number\">2023</span><span class=\"token operator\">-</span><span class=\"token number\">07</span><span class=\"token operator\">-</span><span class=\"token number\">23</span> <span class=\"token number\">15</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span> <span class=\"token comment\"># 2</span>\r\n<span class=\"token number\">2023</span><span class=\"token operator\">-</span><span class=\"token number\">07</span><span class=\"token operator\">-</span><span class=\"token number\">24</span> <span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span><span class=\"token operator\">+</span><span class=\"token number\">09</span><span class=\"token punctuation\">:</span><span class=\"token number\">00</span> <span class=\"token comment\"># 3</span>\r\n<span class=\"token number\">2023</span><span class=\"token operator\">-</span><span class=\"token number\">07</span><span class=\"token operator\">-</span><span class=\"token number\">23</span> <span class=\"token comment\"># 4</span></code></pre></div>\n<p>처음에 Datetime을 초기화해주고 <code class=\"language-text\">a = a.replace(tzinfo=tz.UTC)</code>를 통해 타임존을 replace해주니 위 출력결과 처럼 <code class=\"language-text\">#1</code>에서 <code class=\"language-text\">#2</code>처럼 변했습니다.<br>\n이 상태에서 KST로 timezone을 변경해주고 하루를 빼주니 원하는 결과가 나왔습니다.</p>\n<h2 id=\"결론\" style=\"position:relative;\"><a href=\"#%EA%B2%B0%EB%A1%A0\" aria-label=\"결론 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>결론</h2>\n<p>사실 이런 사소한 오류들이 원하는 로직처럼 흘러가지 않는 경우가 있습니다.<br>\n특히나 날짜를 가지고 데이터 조작을 하거나 데이터 쿼리 조건을 날린다던지 그랬을 때 쿼리는 또 정상적으로 작동은 합니다만 집계하는 데이터와 전체 데이터의 날짜 범위가 맞지 않는 경우가 발생합니다..!<br>\n이런 에러들은 테스트 코드를 통해 잡지 않는 이상 어렵다고 생각합니다. 하지만 이제 일이라는게 언제나 테스트 코드를 짤 수는 없을 수도 있으므로..!</p>\n<p>이번에 파이썬에서 처음에 알게 되어 다른 분들에게 제 글이 도움이 되었으면 합니다!</p>","tableOfContents":"<ul>\n<li><a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0-%EC%A0%84\">들어가기 전</a></li>\n<li><a href=\"#%EC%99%9C-%EC%98%88%EC%83%81%EB%8C%80%EB%A1%9C-%EC%95%88%EB%90%90%EC%9D%84%EA%B9%8C\">왜 예상대로 안됐을까</a></li>\n<li><a href=\"#%ED%95%B4%EA%B2%B0-%EB%B0%A9%EB%B2%95\">해결 방법</a></li>\n<li><a href=\"#%EA%B2%B0%EB%A1%A0\">결론</a></li>\n</ul>","frontmatter":{"title":"파이썬에서 타임존 트러블 슈팅","summary":"세상에 이렇게 혼란스러운 일은 없었다..! 이 시간은 UTC인가 KST인가 아니면 또 다른 무엇인가","date":"2023.08.26.","categories":["Python"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/webp;base64,UklGRvwAAABXRUJQVlA4IPAAAACwBQCdASoUABQAAAAAJaQDLs2AOAA6RjyVZ4AcyT+M2igZIByhf9q/KHjK/0zOzXrCCarYswAA/v//vi4vw/8C9ZQ7H+H//yCwbQPvsZtVP/0ES//obRwOWqfhB6QluKlBWVv/00//+CZuyt2HnR8rj3PH4g+AF7BjHL/DERmaNf+iMa2Vn/8w5vZ6J8f/zWL84nce2QIW+sKRZGr/3/++a+72/AQG7P0f+Vx+2n8ZbXOmM113LcubNJdYTmvhHp8ioh/Ssay6McI8Hv4WzVhoxfjdbd0Vnn7uGhnuuiz+QfZ5Lvn/yafX9rRFNCCAAAA="},"images":{"fallback":{"src":"/static/97afc7f825b0ddb0803e2cd1be787df7/9c0a1/chocoball.webp","srcSet":"/static/97afc7f825b0ddb0803e2cd1be787df7/e64f1/chocoball.webp 100w,\n/static/97afc7f825b0ddb0803e2cd1be787df7/8b00d/chocoball.webp 200w,\n/static/97afc7f825b0ddb0803e2cd1be787df7/9c0a1/chocoball.webp 400w","sizes":"(min-width: 400px) 400px, 100vw"},"sources":[]},"width":400,"height":400}},"publicURL":"/static/97afc7f825b0ddb0803e2cd1be787df7/chocoball.webp"}}}}]}},"pageContext":{"slug":"/python/timezone_ts/"}},"staticQueryHashes":["2269898903"],"slicesMap":{}}